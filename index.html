<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Community Upload Gallery</title>
    <link rel="stylesheet" href="styles.css">
    <script src="script.js" defer></script>
</head>
<body>

<!-- User Upload Form -->
<section id="upload-section">
    <h2>Upload Your Image</h2>
    <form id="upload-form">
        <label for="upload-file">Select an Image:</label>
        <input type="file" id="upload-file" name="file" accept="image/*" required>
        <label for="description">Description:</label>
        <textarea id="description" name="description" rows="3" required></textarea>
        <button type="submit">Submit for Approval</button>
    </form>
    <p id="upload-status"></p>
</section>

<!-- Button to Access Admin Panel -->
<section id="admin-access">
    <button onclick="promptAdminPassword()">Go to Admin Panel</button>
</section>

<script>
    // Check if the IP is banned
    fetch('https://checkip.amazonaws.com/')
        .then(response => response.text())
        .then(ip => {
            const bannedIPs = JSON.parse(localStorage.getItem("bannedIPs")) || [];
            if (bannedIPs.includes(ip)) {
                window.location.href = "banned.html";  // Redirect if banned
            } else {
                saveLatestIP(ip);
            }
        })
        .catch(err => console.error('Failed to fetch IP:', err));

    // Save the latest IP address to localStorage (for tracking)
    function saveLatestIP(ip) {
        const recentIPs = JSON.parse(localStorage.getItem("recentIPs")) || [];
        if (!recentIPs.includes(ip)) {
            recentIPs.push(ip);
            localStorage.setItem("recentIPs", JSON.stringify(recentIPs));
        }
    }

    // Admin Panel Access (with password)
    const adminPassword = "amongus";

    function promptAdminPassword() {
        const password = prompt("Enter Admin Password:");
        if (password === adminPassword) {
            window.location.href = "admin.html";
        } else {
            alert("Incorrect password.");
        }
    }
</script>

</body>
</html>
